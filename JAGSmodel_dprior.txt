######################################################################################################
######################################################################################################
#### JAGS model file written by runjags version 2.0.4-4 on 2019-09-17 14:58:23 
######################################################################################################
######################################################################################################

### Model template as follows - ensure this is syntactically correct before running the model!

model{

# In the BUGS/JAGS language we must use an explicit for loop:
for(i in 1:N){
	# These lines describe the response distribution and linear model terms:
	log.urine01[i] ~ dnorm(intercept[C[i]] + c.self_coefficient[C[i]] * c.self[i] , 
	regression_precision[C[i]])
	#regression_fitted[C[i]] <- intercept[C[i]] + c.self_coefficient[C[i]] * c.self[i] 
  C[i] ~ dcat(xi[])
}


# These lines give the prior distributions for the parameters to be estimated:
for(k in 1:K) {
regression_precision[k] ~ dgamma(0.001, 0.001)
intercept[k] ~ dnorm(0, 10^-6)
c.self_coefficient[k] ~ dnorm(0, 10^-6)
}

mass <- 1
for(k in 1:K) {
mass.vec[k] <- mass / K
}
xi ~ ddirich(mass.vec)

} # end model loop

# These lines are hooks to be read by runjags (they are ignored by JAGS):
#monitor# regression_precision, intercept, c.self_coefficient, deviance, dic, xi
#modules# glm on
#response# log.urine01
#residual# regression_residual
#fitted# regression_fitted




######################################################################################################
######################################################################################################
#### Data 
######################################################################################################
######################################################################################################

data{
"log.urine01" <- c(8.55735154708575, 7.99125546723198, 7.87860609334387, 8.87514566626058, 9.22070413161835, 8.72071309201841, 8.8772155565327, 8.61033019763496, 8.33546069277545, 8.40784254078239, 8.85612055298489, 8.25855480853756, 7.64522250343651, 7.75191704322779, 8.42291246472328, 7.87140128735277, 8.10321496446552, 8.96437446387332, 8.14517908626287, 7.36042652971186, 8.88923944813704, 7.65806771968319, 8.25136607909277, 8.87547983748755, 8.4418252316524, 8.46984885274462, 7.95326264587574, 8.05364259727092, 8.16410886603327, 8.0761607821989, 7.95344892660134, 8.05933843232726, 8.61646780774726, NA, 8.39143692839361, 8.62402108924438, 8.67662904391444, 7.67646229435033, 8.1695074554988, 8.42697238523598, 8.40280667671301, 8.50016465090144, 8.67502404188492, 9.27866799544548, 8.37187952541018, 8.57359854381101, 8.35533659382784, 8.1308504600788, 7.96378889010151, 8.20582411096825, 8.40188687543401, 8.08338953909896, 8.90068733568617, 8.58362035756462, 9.09785667159156, 8.08865129846556, 8.41068541824663, 7.88333902169254, 7.55774435263797, 8.77397604687929, 7.9997853186511, 8.78697170151575, 8.09272268421484, 8.46265750445233, NA, 8.70815270389004, 9.55326743852263, 8.63598361204449, 8.74932102174788, 8.25696652235573, 8.79324658059146, 8.23576304739767, 7.82931307277468, 8.77104481935067, 8.41251084398363, 9.20744989306105, 8.82427343539705, 7.92756429660472, 8.67965775545571, 8.73354814849245, 8.7032838509432, 8.73987469376321, 9.44629441521079, 7.56032041533051, 8.35133067123356, 7.91777869233185, 9.29553998035289, 8.54063109979672, 8.88358235081923, 8.43053193809101, 8.37140600403651, 8.94258975322166, 8.71234273253865, 7.6300417102983, 8.12480921296862, 8.91763191681287, 8.20351274533336, 8.40719041420233, 7.62943391838754, 7.83970869044209, 8.40422955036052, 7.88836450297246, 8.83214896866274, 7.64510689497436, 9.04466808340979, 8.84540469063182, 9.35072339651219, 8.72874834346656, 8.57798503391472, 9.24987728053215, 8.50671876769333, 8.37283236016545, 7.41565285803732, 8.28801637373926, 8.69968075863197, 8.60879832916336, 9.08869294478595, 8.24209939998369, 8.72266722190693, 7.69166868124206, NA, 8.22664386466936, 7.65530505858533, 7.74006347528276, 8.18868366652413, 8.77829651062514, 8.69260286057441, 8.43997166300308, 8.31037455726736, 8.36759890930031, 9.07037584570547, 8.70589743846505, 7.95902616220328, 8.6088560186779, 7.93849283095815, 7.85862081238979, 7.72488799738798, 7.69277304358511, 8.50097217038939, 9.30535266804492, 8.44922763042369, 7.95206858755498, 8.57320448605574, 8.55965385031545, 8.15155448103419, 8.14957945143906, 8.87577358995851, 8.06574611582213, 7.93690004768603, 8.61806498328881, 8.78286362735457, 8.40486079472189, 8.970915613727, 8.50588569736322, 7.70156571437988, 8.5959776352446, 8.63968160451672, 8.3775628759417, 7.89056683150514, 8.22811799664938, 8.37207792783997, 8.74267016658279, 8.53502309173403, 8.83529306869738, 8.95283987727109, 9.10008217826542, 8.60647067344812, 7.9529503156372, 8.56394408615637, 7.72421775607602, 8.51696970349172, 8.70922866609698, 8.57791126020731, 8.1740788406459, 8.46076785932952, 8.88523226661463, 8.58471515980578, 9.09464799652152, 7.28855467506203, 8.82075466896354, 8.37561237512438, 8.87417902655817, 8.12981749787771, 7.96264295562919, 9.19917119490126, 7.52511544097817, 8.10344367822163, 8.8260304232138, 7.93047178859644, 8.44426368406252, 7.90870841659638, 8.2943228680504, 8.43700384023913, 7.90120534973893, 8.43331680628746, 8.66133084134636, 8.29595119948456, 8.96473441698454, 8.92949903609112, 8.21558740579748, 9.05862312961516, NA, 8.45290569737338, 8.82727435637226, 8.34099793323287, 9.18718906934307, 8.11064455071709, 7.94105175872067, 8.04703447280566, 8.68192756845812, 8.29975877569316, 8.07885504674709, 8.95475341974952, 8.14304537221542, 7.78976730401365, 8.5049122536705, 8.88242382469556, 8.27962561551574, 7.75404988817403, 8.95712511453557, 8.35690499820237, 8.46958124127641, 8.41366366298111, 8.89043073069462, 8.72651277973928, 7.02133635453438, 8.560464910136, 7.98516473127317, 8.52190877849665, 8.4038836999975, 8.82851282787963, 8.38920799490126, 9.12571839660964, 8.92352531476049, 7.76167715721831, 8.47142041455924, 8.86124756369268, 8.67456012481069, 8.8801404925887, NA, 8.51478969310405, 8.95266744653265, 8.00836650300632, 8.65294931295421, 8.68638093457926, 8.65162845729787, 7.8832019123441, 8.38096041005014, 7.87095174279076, 8.65038900563408, 8.23879807590347, 9.47259197096748, 8.3568159626399, 8.81336174241828, 8.4148103335589, 8.89479994740135, 8.39152039656381, 8.5227060456877, 8.1379034080857, 8.96613420575568, 8.46320326275403, 8.58930138435207, 7.78870286520373, 8.98702012407585, 8.60375481372992, 8.4944090956116, 8.45982070844778, 8.87944292904364, 8.11520029851031, 8.09277752215947, 8.05948435091821, 8.17352219104069, 7.25071080286624, 8.96467647711871, 8.5460206646417, 7.59097758904624, 8.81962003417604, 8.63846312508754, 8.26739044111306, 8.08790838542481, 8.73096486377114, 8.28991515470848, 8.3542853545028, 8.1963966582086, 8.27113690207453, 8.2413661630518, 8.29997155057744, 8.33272497952891, 8.71682872757029, 7.83370804629687, 8.58373320724605, 8.64141210950138, 8.75973304844106, 8.77453647224416, 8.73397746394817, 7.55433447327504, 8.73173809709106, 8.73935359199199, 7.75336288713985, 8.02331410604408, 8.60925260781242, 7.82168806621454, 8.52600617245673, 8.19117208004725, 8.22812538426395, 8.86707173896707, 8.13946198175741, 8.7017143776832, 8.27719482663591, 8.53753419233192, 8.01099832908251, 7.68424990875762, 8.91147619271836, 8.91215617032305, 7.9542499205974, 8.13980659138613, 7.17196349849498, 8.33830983691132, 8.85764766720025, 8.25919030248442, 8.43234602291925, 8.11875856456585, 8.01139362226829, 7.95508899282265, 8.46887128392392, 8.53010679206488, 8.61219135391653, 8.82738924607827, 8.79980738182683, 7.89333469184131, 8.74380505487026, 8.88810981374807, 9.17537440904366, 7.91349758004397, 8.3178854995702, 8.43689942780318, 8.67500418537528, 9.08138797850221, 7.7838180512604, 8.41763040866861, 8.57476217915281, 9.03454857661007, 8.4110947360399, 8.62520761878509, 8.79004083254571, 9.01225414136923, 9.22587598689875, 7.57815509290492, 8.10728891112067, 9.40700105803, 8.20649951606727, 8.77623424334468, 7.7748344615997, 8.73369345201936, 8.17440047203243, 8.27668849961255, 8.9530664553193, 9.02239220221632, 8.61079351869252, 9.43578330787839, 8.85461468292688, 9.0293027412723, 8.3050374041906, 8.74850044761507, 8.36898744292153, 8.43123542035709, 8.61486948674229, 8.92463527085345, 7.39075834798899, 8.28105636445625, 8.58615158403586, 8.16478296431968, 8.75037059761093, 8.58506761937836, 8.22514953209109, 8.41396251663656, 8.4589988544977, 7.98784405453731, 8.6671589753359, 8.1942817494808, 8.69654032883849, 8.0217685106823, 8.0454105478881, 8.00072497456601, 7.61513420896623, 8.03278839302514, 9.20157996412861, 8.20176991321136, 9.36244297195082, 8.56136171487567, 8.30981155477449, 8.31273232600357, 8.7150071068663, 8.29381620290636, 8.56306414389977, 8.64540292763774, 8.37396294253574, 8.58377334143384, 8.71822224780817, 8.52829562663015, 8.57631100363745, 8.71045618922359, 8.41789855659379, 8.74099387052806, 8.49136035995356, 9.050470703881, 8.49958359211073, 8.48968048599533, 7.96236499647549, 8.92942335454786, 8.24415633876591, 8.86843562042473, 8.81064930291529, NA, 8.35035362781966, 7.90918264548649, 8.31222490853128, 9.13911164672053, 8.559904519718, 8.20649951606727, 7.85467787969161, 8.36788369960507, 8.40837225395926, 7.49863701984209, 8.02383098021456, 8.62194090495222, 8.6606162373897, 7.81039396496853, 8.56223037821447, 7.74882645636944, 8.44264580991863, 8.33439565332438, 8.89358655413005, 8.62281636916811, 7.50894976642649, 8.16744395319297, 8.39048254156826, 7.5947636429989, 8.05473407473883, 8.38634015748282, 8.35636482460372, 8.58200241558391, 8.28373088836071, 8.03555537548753, NA, 8.26311464368539, 7.79123329982383, 7.97527385672461, 7.61633248099482, NA, 7.34636533448322, 7.83208538250946, 8.30935454181558, 8.21024447763329, NA, 8.32697582233829, 8.12773689547161, 9.29443253727992, 8.68634460931825, 8.5476957228313, 8.82083543562274, 8.05192295708225, 8.06693077780998, 9.09835640843157, 8.53784390700557, 8.79682758603922, 8.01451644035092, 8.89061669365857, 8.99501964217876, 8.52951137674511, 7.67258895549316, 8.32217552271831, NA, 9.31045354933169, 8.97079870686135, 8.64098187873805, 8.5011673942293, 6.35232543172682, 8.11931724823467, 7.94800848228574, 7.73518572828966, 8.14505205220425, 8.28929506925983, 9.04752750280415)
"c.self" <- c(-0.811139540803303, -0.315073538358654, -0.015876977545549, -0.101652846454961, 0.123644306662746, 0.650444314341284, -0.25949542508882, 0.227775875447549, 0.86300981699406, -0.156578376462949, 0.447413386928034, -0.587681975411912, -0.197455609870232, -0.0822866698362237, 0.0237931837239298, -0.361156597337196, -0.307544774287607, 0.271267315920428, 0.175304295146733, -0.519040868588691, -0.0532989720243897, -0.764715850362339, -0.0813295433943235, 0.654419925594146, -0.56623258991925, 0.46083932579227, -0.0697563665265211, 0.457909612194673, -0.304585650282967, -0.0764063978006053, -0.0462487023603284, 0.197714455838316, -0.181429736386265, 0.165526138072838, -0.236063304454092, 0.172895981490553, 0.974692791034315, -0.996853827365235, 0.301142033097323, 0.778078151331778, 0.201127167344843, 0.494706681465461, 0.319634736477562, 0.0246236497187571, 0.304738370131483, -0.564493105710113, -0.489373945761062, -0.426506409867693, -0.269871872271466, 0.645675199879054, -0.508577741716458, -0.117262925173041, 0.0269670067954131, 0.503698991341974, 0.00391324749590005, -0.503822600548721, -0.278614493193273, 0.366351297714944, -0.0315885223777261, 0.616966150329898, 0.0653181821333799, -0.644772284625553, 0.413013203904397, -0.665246384404971, 0.248026833303022, 0.576235653144346, -0.149444514312917, -0.572641310814681, 0.325408436504693, 0.234956802527634, 0.171618639933746, -0.231874370471422, 0.0463908222933895, 0.643280041336496, 0.508488758579608, -0.333781365589479, -0.126360462747263, 0.835596889586711, 0.241644573875705, 0.469032206311194, -0.259048315911095, -0.333922624642518, 0.453362075277806, -0.136221997215648, 0.191066053239757, -0.0349137691365087, 0.194983987052989, 0.257593662546103, 0.68330168184929, -0.198008799019705, -0.0835182057620738, 0.342349839834988, 0.0662896832274367, -0.761655497869746, -0.910206850054607, 0.372319923317603, 0.341581446025776, 0.290061293254231, -0.0521122716773164, -0.746262860354456, -0.148080978299811, -0.135060424059679, -0.121351703112527, -0.695449206100992, -0.552062757799694, 0.76352744354649, 0.388790145520279, -0.466106918328748, 0.0730855921761187, 0.60704260824382, -0.378438767130627, -0.349083941657177, 0.25252047858049, 0.55141835222679, -0.404054835412705, 0.252850897913833, -0.302870552790863, 0.885302256993658, -0.599063234875642, -0.831574230648467, 0.640351497704946, -0.248240905342673, -0.701865570486091, -0.0321857155874721, -1.1260757387385, -0.922959758633428, 0.247974203748276, 0.832388382495184, 0.12710420892595, 0.408814924344572, -0.125810211074164, 0.0182101813330338, -0.388158296251587, -0.0426717348435783, -0.158391096053148, 0.0411843587031928, 0.179828418266197, -0.301039211084731, -0.11819085866186, 0.179765572683193, -0.0946251934752311, -0.334498733532159, 0.260498531692605, -0.0517188387238718, -0.520480345391232, 0.00892104800017179, -1.24071928632249, -0.251931634752944, -0.611287507050255, 0.444187850930241, 0.019610128618222, -0.262495887006238, -0.346593618832181, 0.246280483074653, -0.258732434464823, 0.254026627293321, 0.584201474071374, -0.490343428306932, -0.679499131297238, 0.205950084553484, -0.0567741953953949, -0.01974540324861, 0.392355048987884, 0.0920726881125624, 0.631556815573308, 0.866601622633553, 0.357413586826206, -0.266649400393132, 0.0258958614265001, -0.0338908829783069, 0.223422520810585, 0.260592483683206, 0.408302908776388, -0.0309702810271286, -0.295446707221913, -0.0474502204406573, 0.00141415812955081, 0.0245705002992764, -0.159586189925101, 0.477367742615794, -0.06700383550311, -0.232679328532726, 0.0657579032940898, 0.429284465411049, 0.589698033999198, -0.793640613249864, 0.0474798288806024, -0.183284995611825, -0.444015765964979, 0.220961115321177, 0.29073647735485, 0.205985973420445, 0.385002469071296, -0.248410486759616, -0.025069425729713, 0.129208156542031, -0.0547062429728129, 0.47909145126637, 0.699162737304228, 0.277733093599069, 0.631275385021334, -0.898416829717147, -0.219318157526438, 0.746981419283271, 0.360182191048382, -0.74835493424148, -0.137012995341841, 0.129725478285525, -0.618912139426417, 0.70862436885441, 0.0266538659906086, -0.277829930871974, 0.474950838587496, 0.0168108221589147, -0.135526673683916, -0.21875951362801, -0.217304630076573, 0.335505682058079, -0.472764387330354, -0.219182504307534, -0.164145507735716, -0.0688417191788275, 0.015662344276139, -0.507116518813976, 0.705568818560055, -0.00470985566260218, 0.122169297248197, 0.254050771628156, -0.56547889850877, -0.0985306616595167, 0.776840744292333, 0.135821977835972, 0.513460614480929, 0.276350803792253, -0.804808306424301, 0.224935819467921, 0.0650216863708533, 0.37699244566676, -0.00751544832772133, 0.382213333220363, 0.401999371150652, -0.0523883135663752, 0.260148632809811, 0.170783665382558, 0.153121808320128, -0.258352836665964, 0.23807528795289, -0.162703797471305, -0.377261648512623, -0.0479834826849963, 0.376600935035805, 0.166622457165332, 0.0506608482040267, 0.0962066180285586, 0.133341526546172, -0.452234200460215, 0.672984996244363, 0.328703991800975, -0.204505541788414, -0.971220294181528, -0.104516958468292, -0.122834687171139, -0.279495718187251, -0.304300768533344, -0.465515905427051, -0.963712392718072, -1.24053989964505, -1.67101448384165, 0.143444641697942, 0.00333430446426419, -0.033759406592214, -0.110733433606093, 0.260022639235316, 0.0649463332747171, 0.554042163838663, 0.297875554823658, 0.252085125484118, -0.210891014872798, -0.265569652996483, 0.157895595798253, -0.268245770093379, -0.68362728936297, 0.172618816904302, -0.144519883509501, -0.226709940952379, 0.103095408416326, -0.559533274642104, -0.497211692260726, 0.352159752166868, -0.461384451894483, -0.497476144355918, -0.0729544704493943, 0.815088035342795, -0.220708047754938, -0.665569326409413, 0.645695600118145, 0.173168706285654, 0.0694671782995115, -0.0728010176923135, 0.123985794844041, -0.208693004354382, 0.0102031109865823, 0.0410847821523923, -0.069912134532645, -0.328968765522698, 0.313400983441637, 0.0515185826547206, 0.246379835358672, -0.638715826402365, 0.0682104754169526, -0.0959776670813213, -0.583651750298151, 0.165888781417088, -0.0483727259655975, -0.09113548399697, -0.00561983195911075, 0.396767651274622, -0.418720603805649, 0.40768365763647, 0.202244496556906, -0.123650386194102, -0.228752296918111, 0.114238628502802, 0.0685205604505672, 0.396643790769305, -0.315539305380459, -0.394746038987454, 0.778342600439377, -0.338166063943675, -0.306360073709013, 0.0276131810123257, 0.633681541308945, -0.166937087065374, 0.526807632570721, -0.129922343811099, 0.513437330093963, 0.189923285409193, 0.0823566842868946, 0.304263942353256, 0.149695082102326, 0.499501832081805, -0.0702265260138333, -0.127485448140972, -0.0404625301913075, 0.468295186112051, 0.11720068312594, 0.695127155717815, -1.00633852919938, 0.134584788589901, 0.23589357458645, -0.179013105817974, 0.652866955311294, -0.740926575225152, 0.591287564703823, -0.32950235653065, -0.16560460509795, 0.0401233585737728, 0.370426874604792, 0.270216626494399, 1.05125635713054, 0.210146672773314, 0.0158564020242498, -0.533910149490644, 0.395381632730762, 0.540226731759022, -0.0745657503131056, -0.070426897815512, 0.674414558805035, -0.373474759143541, 0.32581676185201, -0.252028416428578, 0.019922939762953, 0.16868659984801, 0.152754504581409, 0.340642725585782, -0.172907529370958, -0.144199227090104, 0.133046365147507, 0.00711978817555092, 0.517075528954999, -0.0609257308074227, -1.17146631465065, -0.170902134774517, 0.314272793336178, -0.999965454115547, -0.0393799912214998, -0.0345512094612594, -0.206879367740349, 0.391839792838102, -1.74582935658428, 0.0519447115023333, 0.516807918689851, 0.177661217628826, -0.158372861409756, 0.438433512427828, 0.172658104746684, -0.0310344961048514, -0.0615048478631604, 0.212634808176825, 0.274136735681788, 0.643740727630913, 0.234788623617693, -0.350987080938016, -0.306645542805398, -0.181379978180038, 0.430367956789205, 0.209244376273015, -0.00564330935233848, 0.25281463771061, 0.212892716042242, -0.186221213809374, -0.0441671351417554, 0.314352355516903, 0.0675657722610268, -0.177980520371262, 0.054635225503187, 0.884587083399758, 0.506161636100513, 0.554486246665917, -0.140425017002437, -0.521668383041506, 0.20707469366994, 0.319146588198958, 0.371708384527523, 0.247137831852241, 0.495931717559635, -0.0642118374120777, -0.292491837284, -0.0766528204727397, -0.290582260351923, -2.06819652067031, -0.375247488252062, 0.143959144972117, -0.100622508806284, -0.06413715884106, -0.0765464032330456, 0.284440381486013, -0.40854481450895, -1.25462960085325, -0.843158123734902, -0.822523214239351, 0.185388676308623, 0.708098083306812, -0.379658981918539, -0.18909086276825, 0.235659976165662, -0.00915546831277325, -0.44871360748128, 0.253265782195268, 0.288612377939025, -0.249425250830891, 0.507252465739214, 0.601158895628924, -0.186896420617103, 0.289527419952005, 0.0145739018420734, -0.1819367892535, 0.152487289826002, 0.197893242769467, 0.293999255661046, 0.436510811748253, 0.164243743977796, 0.421202356328541, 0.85225147648875, -0.518670429614275, 0.206703480409988, -0.615656522781131, -0.362303719601698, 0.0108011871500278, 0.35267762895659, -0.104626394441159, 0.742838494989329, -0.00616256148439298, 0.632169067244408, 0.440497803692633, -0.116880913541827, -0.20859074016114, -1.28174462465297, 0.721489330290428, -0.280583747400222, -0.757082458590197, -0.383480826524316, -0.163763496487716, 0.369482590009335)
"N" <- 484
"K" <- 20

}

######################################################################################################
######################################################################################################
